local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local Player = Players.LocalPlayer
local Backpack = Player.Backpack

local GameEvent: RemoteEvent = ReplicatedStorage:WaitForChild("Event")

local library = require(script.ModuleScript)--loadstring(game:HttpGet("https://raw.githubusercontent.com/lolz59/library/refs/heads/main/ice.lua"))()

local Menu = library.new("Trench war UI")

local Main = Menu:CreateSection("Main")

local states = {
	LoopDamage = false,
	Multiplier = 1,
}

Main:CreateSlider("Damage mutliplier", 100, function(value)
	states.Multiplier = value
end)

Main:CreateButton("Get sniper", function()
	local Character = Player.Character

	if Character and Character.PrimaryPart then
		GameEvent:FireServer(GameEvent, "Spawn", Character.PrimaryPart.Position)
		task.wait(1)
	end
end)

Main:CreateButton("Goto", function()
	local Character = Player.Character

	local Nearest = nil
	local MaxDistance = 10000
	
	for i, Target in ipairs(Players:GetPlayers()) do
		if Target ~= Player and Target.Character and Target.Character.PrimaryPart then
			local Distance = (Character.PrimaryPart.Position - Target.Character.PrimaryPart.Position).Magnitude
			
			if Distance < MaxDistance then
				Nearest = Target.Character.PrimaryPart
				MaxDistance = Distance
			end
		end
	end
	
	if not Nearest then return end
	Character:PivotTo(Nearest.CFrame)
end)

local MT = getrawmetatable(game)
local Old = MT.__namecall
setreadonly(MT, false)

MT.__namecall = newcclosure(function(Remote, ...) 
	local Args = {...}
	local Method = getnamecallmethod()

	if Remote.Name == "RemoteEvent" and Method == "FireServer" then
		if Args[2] ~= nil and typeof(Args[2]) == "number" then
			local Multiplier = tonumber(states.Multiplier)

			if Multiplier ~= nil then
				Args[2] = (Args[2] * Multiplier)

				Remote[Method](Remote, unpack(Args))
			end
		end
	end

	return Old(Remote, ...)
end)
setreadonly(MT, true)
